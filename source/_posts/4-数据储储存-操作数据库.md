---
ctitle: 4.数据储储存,操作数据库
date: 2020-09-10 13:46:24
tags:
---

# MySql介绍

​		为什么选择使用mysql，而不是mogondb。

​			mysql是企业内最常用的储存工具，一般都有专人维护。

​			mysql是社区内最常用的储存工具，有问题随时查。

​			mysql本身是一个复杂的数据库软件，本课只讲基本使用。

mysql是web serve中最流行的关系型数据库。

官网免费下载，用来学习。

轻量级，易学易用。



官网下载直接安装以后，在执行的过程中需要输入root用户名密码，要记住这个密码。

https://zhuanlan.zhihu.com/p/37152572

然后在安装mysql可视化软件：workbench

![image-20200910144604377](https://zcx666666.oss-cn-beijing.aliyuncs.com/img/image-20200910144604377.png)![image-20200910144626969](https://zcx666666.oss-cn-beijing.aliyuncs.com/img/image-20200910144626969.png)![image-20200910144714569](https://zcx666666.oss-cn-beijing.aliyuncs.com/img/image-20200910144714569.png)



# mysql数据库增删查

## 建库	

​	创建myblog数据库

![image-20200910145719803](https://zcx666666.oss-cn-beijing.aliyuncs.com/img/image-20200910145719803.png)![image-20200910145756338](https://zcx666666.oss-cn-beijing.aliyuncs.com/img/image-20200910145756338.png)![image-20200910145902934](https://zcx666666.oss-cn-beijing.aliyuncs.com/img/image-20200910145902934.png)

创建完成以后就会出现创建的myblog库。![image-20200910150024473](https://zcx666666.oss-cn-beijing.aliyuncs.com/img/image-20200910150024473.png)

​	执行show databases;查询



## 建表

![image-20200910150251814](https://zcx666666.oss-cn-beijing.aliyuncs.com/img/image-20200910150251814.png)

id：标识，主键

建表只会建表结构

![image-20200910150709222](https://zcx666666.oss-cn-beijing.aliyuncs.com/img/image-20200910150709222.png)

user表：

​		表结构column：代表有多少列，比如id是一列，username是一列，password是一列。代表有几列的意思。

​		表结构datatye：代表类型。int整数类型，varchar（20）代表字符串类型最长20个字符。

​		表结构PK主键：所有行不能重复。如何不能重复就是需要把AI自动增加这个打上Y。

​		表结构nn不为空：必填项不能为空

![image-20200910151228970](https://zcx666666.oss-cn-beijing.aliyuncs.com/img/image-20200910151228970.png)

blogs表：

​		longtext是博客内容可以存储很大，一般情况是4g内容

​		bigint（20）存储更大的数字。

![image-20200910152449236](https://zcx666666.oss-cn-beijing.aliyuncs.com/img/image-20200910152449236.png)

建表：选择myblog-Tables右键-create Table

![image-20200910152710292](https://zcx666666.oss-cn-beijing.aliyuncs.com/img/image-20200910152710292.png)

![image-20200910152944019](https://zcx666666.oss-cn-beijing.aliyuncs.com/img/image-20200910152944019.png)

创建完成以后会展示这些![image-20200910153015233](https://zcx666666.oss-cn-beijing.aliyuncs.com/img/image-20200910153015233.png)

这就是创建表的sql语句。不用管他直接apply

![image-20200910153140742](https://zcx666666.oss-cn-beijing.aliyuncs.com/img/image-20200910153140742.png)

创建完成以后左侧点刷新，刚才创建的表就会出现。

![image-20200910153642408](https://zcx666666.oss-cn-beijing.aliyuncs.com/img/image-20200910153642408.png)

两个表都创建成功。





## 表操作（node连接数据库的基础）

表操作主要就是：增删改查。

更新数据时候会报错，必须查询为主键。这种情况使用下边解决办法

https://jingyan.baidu.com/article/e5c39bf58ed69239d76033a4.html

![image-20200910174000025](https://zcx666666.oss-cn-beijing.aliyuncs.com/img/image-20200910174000025.png)

-- 选择连接的库是哪个
use myblog;



-- show tables  这是注释，这个语句的含义是显示数据库所有的表



-- 增删改查

-- 增,当存在关键字时候只需要使用`引起来`。增的时候insert into 后边跟着表名（表列，id因为是自动生成的所以不用管） values(对应的列值)
-- insert into user(username,`password`,realname) values ('lisi','123456','李四');







-- 尽量避免使用星号，一般数据大的情况会音响性能。

-- 查,select就是查询 *代表全部 from 查哪个表就查哪个user
-- select * from user

-- 只查指定列。中间用逗号隔开。
-- select id,username from user

-- 精确查询的话就是需要输入查询条件。where代表查询条件。后边跟条件内容就行username='zhangsan'。
-- 如果多条件的情况下就使用and-代表并且。or-代表或者。<>-代表不等于。
-- select * from user where username='zhangsan' or password='123456';

-- 模糊查询的情况下把=替换成like %zhang%。模糊查询的值需要用%包起来。
-- select * from user where username like '%li%';

-- 按照条件查询回来的数据排序,在条件的最后加order by 跟上要排序的列名。默认正序，后边加desc的话就是倒序
-- select * from user where password like '%1%' order by id desc







-- 改。修改数据就是update 表名user 更新set realname指定列改为什么 '李四测试' 这样会把所有列的都修改。
-- 所以最后必须要加条件，改谁的。查询where username='lisi' 
-- update user set realname='李四测试111' where username='lisi';







-- 删除，delete删除 from 表名user ，后边必须要跟查询条件否则就会删除整个表。
-- delete from user where username='lisi'
-- 删除数据以后，如果在新增就会延续之前的号增加。不会管是否连接。
-- 正常的删除不是上边那么操作的。如果想删除的话。就在设计表的时候加一列，state。默认值是1。如果不想要哪个了就直接改state值



## 总结

​	1：如何建库如何建表。使用workbench如何操作

​	2：建表中字段的类型，int、bigint、varchar、longtext

​	3：sql语句实现增、删、改、查。

​	4：如何实现软删除







# nodejs操作Mysql

## 示例：用demo演示，不考虑使用

初始化一个mysql首先需要创建一个文件夹。文件夹中创建一个index.js

![image-20200914160005805](https://zcx666666.oss-cn-beijing.aliyuncs.com/img/image-20200914160005805.png)

初始化项目后下载mysql包后引入。

![image-20200914170730197](https://zcx666666.oss-cn-beijing.aliyuncs.com/img/image-20200914170730197.png)

链接sq需要以下几步

1：引入mysql

2：创建连接对象

3：开始连接

4：执行sq语句

5：关闭连接





## 封装：将其封装为系统可用得工具

在原来的blong-1项目中安装mysql![image-20200914172406017](https://zcx666666.oss-cn-beijing.aliyuncs.com/img/image-20200914172406017.png)

然后在创建一个config得文件夹中创建db.js。里边通过环境变量进行不同的配置。主要就是配置链接哪个数据库

![image-20200914175423301](https://zcx666666.oss-cn-beijing.aliyuncs.com/img/image-20200914175423301.png)

将定义的配置导出后新建一个db文件夹中创建mysql.js来处理sq语句

![image-20200914175535783](https://zcx666666.oss-cn-beijing.aliyuncs.com/img/image-20200914175535783.png)

## 使用：让API只接操作数据库，不再使用假数据



