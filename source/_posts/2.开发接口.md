---
title: 2、开发接口
date: 2020-08-14 14:16:08
tags:
---

# 开发接口

首先要了解node.js如何处理http请求

然后搭建开发环境，不用任何框架就需要自己搭建环境

开发接口（暂不考虑链接数据库、登录）

http请求概述介绍

​	问：从页面浏览器输入地址到显示页面得整个过程是什么？

​		1、DMS解析(域名解析到一个真正得ip地址，ip地址对应得一台服务器)，建立TCP链接(客户端和服务器建立TCP链接，这就是三次握手)发送HTTP请求

​		2、serve端接收到http请求，处理后返回

​		3、客户端接收到返回数据（就是serve端返回的），处理数据（渲染页面执行js，这就是页面级别得）



​					request			发送			res简写

​					response		 返回			req简写

# node.js处理HTTP请求

​		get请求如何处理，get请求传入得querystring怎么处理（url传入的参数）

​		post请求如何处理，postdata如何处理

​		路由-接口地址就是路由

### get请求

```javascript
const http = require('http)                       
const server = http.createServer((req,res)=>{
    res.end('hello world)
})
server.listen('8000)
```

nodejs请求http实例，首先需要引入模块

通过http.createServer来创建一个serve。返回一个serve的对象。

监听本地8000端口

浏览器访问http://localhost:8000

![image-20200827111747728](C:\Users\ZIAN KANG\AppData\Roaming\Typora\typora-user-images\image-20200827111747728.png)

get请求，就是客户端要向serve端获取数据，比如查询博客列表。

一般是通过querystring来传递数据。如果a.html?a=100&b=200。

浏览器直接访问就发送get请求。

```javascript
const querystring = require('querystring')// querystring也是一个模块，调用这个模块将url解析
```





### post请求

   	post请求就是客户端要向服务器传递数据

​	   通过postdata传递数据

​		

```javascript
post请求就是客户端要向服务端传递数据
            通过postdata传递数据
            使用谷歌安装postman插件以后再地址栏输入：chrome://apps
            //设置返回数据格式/返回数据
            const server = http.createServer((req,res)=>{

                const method = req.method
                const url = req.url
                const path = url.split('?')[0]
                const query = querystring.parse(url.split('?')[1])
                

                // 设置返回数据格式
                res.setHeader('Content-type','application/json')

                //返回的数据
                const resData = {
                    method,
                    url,
                    path,
                    query
                }

                if(method === 'GET'){
                    //当为get请求时候返回的数据，需要转一下
                    res.end(JSON.stringify(resData))
                }
                if(method === 'POST'){
                    
                        当为post请求时候返回的数据，需要以下几步。是通过数据流的方式。
                            客户端向服务端发送post请求，这时候带来一些数据。数据有时候大有时候小。所以服务端接收数据需要一点一点接收。
                            类似一桶水倒入另一桶水中。中间用水管链接。数据一点点从这个桶流另外一个桶。

                            1、定义postData等待接收数据
                            2、req.on('data', chunk=>{postData += chunk.toString()})代表随时来了数据随时触发。
                            chunk参数代表接收的数据每次都放到postData中。
                            3、req.on('end', ()=>{
                                resData.postData = postData
                                res.end(JSON.stringify(resData))
                            })代表数据接收完毕。然后返回给前端


                    
                    
                    let postData = ''
                    req.on('data', chunk=>{
                        postData += chunk.toString()
                    })
                    req.on('end', ()=>{
                        resData.postData = postData
                        res.end(JSON.stringify(resData))
                    })
                }
                
            })
            server.listen(8000)
```















